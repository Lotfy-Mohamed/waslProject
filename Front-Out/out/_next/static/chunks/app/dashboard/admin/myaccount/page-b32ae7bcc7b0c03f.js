(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2193],{1987:function(e,t,r){Promise.resolve().then(r.bind(r,6480))},6480:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var a=r(7437),s=r(2265),l=r(9095),n=r(3464),o=r(1897),i=r(2623),c=r(5515),d=r.n(c),u=r(9089);function m(){let[e,t]=(0,s.useState)({}),[r,c]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("wasl-token");e?c(e):(0,i.Z)()},[]);let m=()=>{n.Z.get("".concat(o.A,"/auth/get-user-data"),{headers:{Authorization:"Bearer ".concat(r)}}).then(e=>{t(e.data)}).catch(e=>{if(401==e.response.status){(0,i.Z)();return}d().fire({icon:"error",title:"خطأ",text:"حدث خطأ اثناء تحميل البيانات",timer:1e3,timerProgressBar:!0,didOpen:()=>{var e;let t=null===(e=d().getPopup())||void 0===e?void 0:e.querySelector(".swal2-timer-progress-bar");t&&(t.style.background="#d33")}})})};(0,s.useEffect)(()=>{r&&m()},[r]);let[p,x]=(0,s.useState)(!1),[b,f]=(0,s.useState)({}),g=[{label:"البريد الإلكتروني",name:"email",value:e.email,icon:"\uD83D\uDCE7",color:"bg-blue-100 text-blue-700"},{label:"اسم المستخدم",name:"username",value:e.username,icon:"\uD83D\uDC64",color:"bg-green-100 text-green-700"},{label:"رقم الهاتف",name:"phone",value:e.phone,icon:"\uD83D\uDCDE",color:"bg-yellow-100 text-yellow-700"},{label:"الدولة",name:"country",value:e.country,icon:"\uD83C\uDF0D",color:"bg-red-100 text-red-700"},{label:"تاريخ الميلاد",name:"date_of_birth",value:e.date_of_birth||"غير محدد",icon:"\uD83D\uDCC5",color:"bg-purple-100 text-purple-700"}],h=e=>{let{name:t,value:r}=e.target;f(e=>({...e,[t]:r}))},y=()=>{f({first_name:e.first_name,last_name:e.last_name,email:e.email,username:e.username,phone:e.phone,country:e.country,date_of_birth:e.date_of_birth,profile_picture:null}),w(e.profile_picture),x(!0)},[v,w]=(0,s.useState)(null),j=e=>Object.keys(e).map(t=>'\n            <div>\n                <h3 style="font-weight: bold; color: #d33;">'.concat(t.replace("_"," ").toUpperCase(),':</h3>\n                <ul style="padding-left: 20px; color: #6c757d;">\n                    ').concat(e[t].map(e=>'<li style="color: #d33;">'.concat(e,"</li>")).join(""),"\n                </ul>\n            </div>\n            ")).join(""),N=e=>{e.preventDefault();let t=new FormData;t.append("first_name",b.first_name),t.append("last_name",b.last_name),t.append("email",b.email),t.append("username",b.username),t.append("phone",b.phone),t.append("country",b.country),t.append("date_of_birth",b.date_of_birth),"object"==typeof b.profile_picture&&null!==b.profile_picture&&t.append("profile_picture",b.profile_picture),console.log("formDataUser",Object.fromEntries(t.entries())),n.Z.post("".concat(o.A,"/auth/update-user-data"),t,{headers:{Authorization:"Bearer ".concat(r)}}).then(e=>{m(),x(!1),d().fire({icon:"success",title:"تم التحديث بنجاح",timer:1e3,timerProgressBar:!0,didOpen:()=>{var e;let t=null===(e=d().getPopup())||void 0===e?void 0:e.querySelector(".swal2-timer-progress-bar");t&&(t.style.background="#16a34a")}})}).catch(e=>{if(401==e.response.status){(0,i.Z)();return}d().fire({icon:"error",title:"خطأ",html:j(e.response.data),timer:8e3,timerProgressBar:!0,didOpen:()=>{var e;let t=null===(e=d().getPopup())||void 0===e?void 0:e.querySelector(".swal2-timer-progress-bar");t&&(t.style.background="#d33")}})})},_=()=>{x(!p),f({})},[O,P]=(0,s.useState)({old_password:"",new_password:"",new_password2:""}),[S,C]=(0,s.useState)(!1),[k,D]=(0,s.useState)(!1),[E,q]=(0,s.useState)(!1),[z,B]=(0,s.useState)(!1),Z=e=>{let{name:t,value:r}=e.target;P(e=>({...e,[t]:r}))},A=e=>{"old_password"===e?D(e=>!e):"new_password"===e?q(e=>!e):"new_password2"===e&&B(e=>!e)},U=e=>{e.preventDefault(),console.log(O),n.Z.post("".concat(o.A,"/auth/change-password"),O,{headers:{Authorization:"Bearer ".concat(r)}}).then(e=>{C(!1),P({old_password:"",new_password:"",new_password2:""}),d().fire({icon:"success",title:"Password Updated Successfully!",timer:1e3,timerProgressBar:!0,didOpen:()=>{var e;let t=null===(e=d().getPopup())||void 0===e?void 0:e.querySelector(".swal2-timer-progress-bar");t&&(t.style.background="#16a34a")}})}).catch(e=>{var t,r,a,s;if((null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.status)==401){(0,i.Z)();return}d().fire({icon:"error",title:"خطأ",text:(null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.error)||(null==e?void 0:null===(s=e.response)||void 0===s?void 0:s.data)||"حدث خطأ اثناء تحديث كلمة المرور",timer:2e3,timerProgressBar:!0,didOpen:()=>{var e;let t=null===(e=d().getPopup())||void 0===e?void 0:e.querySelector(".swal2-timer-progress-bar");t&&(t.style.background="#d33")}})})};return(0,a.jsx)(l.Z,{currentTab:"account",children:(0,a.jsxs)("div",{className:"p-4 bg-gray-100 min-h-screen",children:[(0,a.jsxs)("div",{className:"flex items-center bg-white rounded-lg shadow-md p-3 max-w-4xl mx-auto flex-wrap",children:[(0,a.jsxs)("div",{className:"ml-6 flex-grow text-right",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-800",children:[e.first_name," ",e.last_name]}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:e.role})]}),(0,a.jsx)("img",{src:e.profile_picture,alt:"Profile",className:"rounded-full border-4 border-blue-500 w-28 h-28 mt-4"})]}),(0,a.jsx)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-4xl mx-auto",children:g.map((e,t)=>(0,a.jsxs)("div",{className:"p-4 rounded-lg shadow-md flex items-center space-x-4 transition-transform transform hover:scale-105 hover:shadow-lg ".concat(e.color),children:[(0,a.jsx)("div",{className:"text-3xl",children:e.icon}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.label}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-800",children:e.value})]})]},t))}),(0,a.jsxs)("div",{className:"mt-8 text-right max-w-4xl mx-auto d-flex justify-content-start flex-wrap gap-4",children:[(0,a.jsx)("button",{onClick:()=>y(),className:"bg-blue-500 text-white px-5 py-2 rounded-md shadow-md hover:bg-blue-600 transition",children:"تحديث البيانات"}),(0,a.jsx)("button",{onClick:()=>C(!0),className:"bg-indigo-500 text-white px-5 py-2 rounded-md shadow-md hover:bg-indigo-600 transition",children:"تغير كلمة المرور"})]}),p&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-gray-800 text-center",children:"تحديث البيانات"}),(0,a.jsxs)("form",{onSubmit:e=>N(e),className:"space-y-4",children:[[{label:"الاسم الأول",name:"first_name",type:"text",value:b.first_name},{label:"الاسم الأخير",name:"last_name",type:"text",value:b.last_name},{label:"البريد الإلكتروني",name:"email",type:"email",value:b.email},{label:"اسم المستخدم",name:"username",type:"text",value:b.username},{label:"رقم الهاتف",name:"phone",type:"text",value:b.phone},{label:"الدولة",name:"country",type:"text",value:b.country||""},{label:"تاريخ الميلاد",name:"date_of_birth",type:"date",value:b.date_of_birth||""}].map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-semibold text-gray-600",children:e.label}),(0,a.jsx)("input",{type:e.type,name:e.name,value:e.value,onChange:h,className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring focus:ring-blue-200"})]},t)),(0,a.jsxs)("div",{className:"space-x-4",children:[(0,a.jsx)("label",{className:"block mb-2 text-sm font-semibold text-gray-600",children:"صورة الملف الشخصي"}),(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:e=>{let t=e.target.files[0];t&&(f(e=>({...e,profile_picture:t})),w(URL.createObjectURL(t)))}}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-md px-3 py-2 flex items-center justify-center space-x-2 bg-gray-50 hover:bg-gray-100 transition-all",children:[(0,a.jsx)("i",{className:"bi bi-upload text-gray-600 text-lg"})," ",(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"اختر صورة"})]})]}),v&&(0,a.jsx)("div",{className:"mt-4 w-full max-w-xs mx-auto",children:(0,a.jsx)("img",{src:v,alt:"Preview",className:"w-full h-48 object-cover rounded-md border-2 border-gray-300"})})]}),(0,a.jsxs)("div",{className:"flex justify-between gap-3 mt-6",children:[(0,a.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 w-50",children:"حفظ"}),(0,a.jsx)("button",{onClick:()=>_(),className:"bg-red-600 text-white px-4 py-2 rounded-md mr-2 hover:bg-red-800 w-50",children:"إلغاء"})]})]})]})}),S&&(0,a.jsx)("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-600 bg-opacity-50 z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-sm",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"تغيير كلمة المرور"}),(0,a.jsxs)("form",{onSubmit:e=>U(e),className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"كلمة المرور القديمة"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:k?"text":"password",name:"old_password",value:O.old_password,onChange:Z,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500",placeholder:"ادخل كلمة المرور القديمة"}),(0,a.jsx)("span",{onClick:()=>A("old_password"),className:"absolute left-3 top-1/2 transform -translate-y-1/2 cursor-pointer text-gray-600",children:k?(0,a.jsx)(u.tgn,{}):(0,a.jsx)(u.dSq,{})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"كلمة المرور الجديدة"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:E?"text":"password",name:"new_password",value:O.new_password,onChange:Z,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500",placeholder:"ادخل كلمة المرور الجديدة"}),(0,a.jsx)("span",{onClick:()=>A("new_password"),className:"absolute left-3 top-1/2 transform -translate-y-1/2 cursor-pointer text-gray-600",children:E?(0,a.jsx)(u.tgn,{}):(0,a.jsx)(u.dSq,{})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"تأكيد كلمة المرور الجديدة"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:z?"text":"password",name:"new_password2",value:O.new_password2,onChange:Z,className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500",placeholder:"أعد إدخال كلمة المرور الجديدة"}),(0,a.jsx)("span",{onClick:()=>A("new_password2"),className:"absolute left-3 top-1/2 transform -translate-y-1/2 cursor-pointer text-gray-600",children:z?(0,a.jsx)(u.tgn,{}):(0,a.jsx)(u.dSq,{})})]})]}),(0,a.jsxs)("div",{className:"flex justify-between gap-4 ",children:[(0,a.jsx)("button",{type:"submit",className:"bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 transition w-50",children:"تأكيد"}),(0,a.jsx)("button",{type:"button",onClick:()=>C(!1),className:"bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 transition w-50",children:"إلغاء"})]})]})]})})]})})}},6231:function(e,t,r){"use strict";r.d(t,{w_:function(){return d}});var a=r(2265),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},l=a.createContext&&a.createContext(s),n=["attr","size","title"];function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach(function(t){var a,s;a=t,s=r[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in e?Object.defineProperty(e,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[a]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>a.createElement(u,o({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>a.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var r,{attr:s,size:l,title:i}=e,d=function(e,t){if(null==e)return{};var r,a,s=function(e,t){if(null==e)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,n),u=l||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),a.createElement("svg",o({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,d,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&a.createElement("title",null,i),e.children)};return void 0!==l?a.createElement(l.Consumer,null,e=>t(e)):t(s)}}},function(e){e.O(0,[9461,7699,6051,3464,7823,2971,2117,1744],function(){return e(e.s=1987)}),_N_E=e.O()}]);